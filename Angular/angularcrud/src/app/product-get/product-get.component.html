<div class="container mt-4">
  <h2 class="mb-4">Liste des Produits</h2>
  <button class="btn btn-outline-secondary mb-4" (click)="addRandomProduct()">Ajouter random</button>
  <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
    <div class="col" *ngFor="let product of products">
      <div class="card h-100">
        <div class="card-body">
          <h5 class="card-title">{{ product.name }}</h5>
          <p class="card-text">{{ product.description }}</p>
          <p class="card-text">
            <strong>Prix : {{ product.price | currency:'EUR' }}</strong>
          </p>
        </div>
        <div class="card-footer">
          <button
            class="btn btn-outline-primary me-2"
            (click)="handleUpdateProduct(product.id)"
            data-bs-toggle="modal"
            data-bs-target="#exampleModalToggle"
          >
            Modifier
          </button>
          <button
            class="btn btn-outline-danger"
            (click)="handleDeleteProduct(product.id)"
          >
            Supprimer
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="showModal" class="modal fade show d-block" tabindex="-1" role="dialog" style="background-color: rgba(0,0,0,0.5);">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalToggleLabel">
          {{ modalType === 'update' ? 'Modifier le produit' : 'Supprimer le produit' }}
        </h5>
        <button type="button" class="btn-close" aria-label="Close" (click)="closeModal()"></button>
      </div>
      <div class="modal-body">
        <ng-container *ngIf="modalType === 'update' && selectedProductId">
          <app-product-edit
            [productId]="selectedProductId"
            (updateComplete)="onUpdateComplete()"
          ></app-product-edit>
        </ng-container>

        <ng-container *ngIf="modalType === 'delete' && productToDelete">
          <p>Êtes-vous sûr de vouloir supprimer le produit <strong>{{ productToDelete.name }}</strong>?</p>
          <button class="btn btn-outline-danger" (click)="confirmDelete()">Confirmer la suppression</button>
          <button class="btn btn-secondary ms-2" (click)="closeModal()">Annuler</button>
        </ng-container>
      </div>
    </div>
  </div>
</div>
